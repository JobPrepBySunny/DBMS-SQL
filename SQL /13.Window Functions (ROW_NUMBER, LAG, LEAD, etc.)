Here is the **Window Functions** section â€” explained in the same clear, beginner-friendly style you prefer.

---

# ğŸŸ¦ **Window Functions (OVER, PARTITION BY, ORDER BY)**

Window functions allow you to:

ğŸ‘‰ Look at **other rows** without actually grouping or merging them
ğŸ‘‰ Perform ranking, running totals, comparisons, and trend analysis

Window functions work using:

### **OVER()**

Defines *which rows* the function should look at.

### **PARTITION BY**

Splits rows into groups (like GROUP BY).
But unlike GROUP BY, original rows are **not collapsed**.

### **ORDER BY**

Defines the order inside the window.

---

# ğŸŸ© **1) ROW_NUMBER()**

**Meaning:**
â€œGive a unique number to each row, based on ordering.â€

**Explanation:**

* Starts at 1 for each partition
* No ties â€” every row gets a different number
* Useful for picking top N rows per group

**Example:**

```sql
SELECT name, salary,
       ROW_NUMBER() OVER (ORDER BY salary DESC) AS rank_num
FROM employees;
```

This means:
â¡ï¸ Assign rank 1 to the highest salary, 2 to next, and so on.

---

# ğŸŸ© **2) RANK()**

**Meaning:**
â€œGive a rank, but allow ties â€” same values get same rank.â€

**Explanation:**

* Same salary â†’ same rank
* Skips numbers after ties (1, 2, 2, 4)

**Example:**

```sql
SELECT name, salary,
       RANK() OVER (ORDER BY salary DESC) AS rnk
FROM employees;
```

This means:
â¡ï¸ If two employees have the same salary, both get the same rank.

---

# ğŸŸ© **3) DENSE_RANK()**

**Meaning:**
â€œLike RANK but **no skipped numbers**.â€

**Explanation:**

* Same value â†’ same rank
* Next distinct value â†’ next rank (1, 2, 2, 3)

**Example:**

```sql
SELECT name, salary,
       DENSE_RANK() OVER (ORDER BY salary DESC) AS dense_rnk
FROM employees;
```

This means:
â¡ï¸ Ties still get the same rank, but numbering remains continuous.

---

# ğŸŸ© **4) LAG(column, offset)**

**Meaning:**
â€œLook at the value from the previous row.â€

**Explanation:**

* LAG helps compare the current row with the previous one
* Used for trends, difference calculation, time series analysis
* If there is no previous row â†’ returns NULL

**Example:**

```sql
SELECT date, temperature,
       LAG(temperature) OVER (ORDER BY date) AS previous_temp
FROM weather;
```

This means:
â¡ï¸ Look at the row just above the current row and return its temperature.
â¡ï¸ First row gets NULL.

---

# ğŸŸ© **5) LEAD(column, offset)**

**Meaning:**
â€œLook at the value from the next row.â€

**Explanation:**

* Opposite of LAG
* Used to compare todayâ€™s value with tomorrowâ€™s value
* If next row doesnâ€™t exist â†’ returns NULL

**Example:**

```sql
SELECT date, temperature,
       LEAD(temperature) OVER (ORDER BY date) AS next_temp
FROM weather;
```

This means:
â¡ï¸ Look at the row below the current row and return its temperature.

---

# ğŸŸ© **6) NTILE(n)**

**Meaning:**
â€œDivide rows into n equal groups.â€

**Explanation:**

* Splits data into buckets (like percentiles or quartiles)
* Useful in statistical analysis

**Example:**

```sql
SELECT name, score,
       NTILE(4) OVER (ORDER BY score) AS quartile
FROM students;
```

This means:
â¡ï¸ Divide students into 4 groups based on score (Q1, Q2, Q3, Q4).

---

# ğŸŸ© **7) SUM() OVER() â€” Running Total**

**Meaning:**
â€œCalculate running total or running sum.â€

**Example:**

```sql
SELECT date, amount,
       SUM(amount) OVER (ORDER BY date) AS running_total
FROM sales;
```

This means:
â¡ï¸ Keep adding amounts day by day and show the accumulated total.

---

# ğŸŸ© **8) AVG() OVER() â€” Moving Average**

**Example:**

```sql
SELECT date, temperature,
       AVG(temperature) OVER (ORDER BY date ROWS 2 PRECEDING) AS moving_avg
FROM weather;
```

This means:
â¡ï¸ Average temperature for the last 3 days (current + previous 2).

---

# ğŸŸ© **9) PARTITION BY**

**Meaning:**
â€œBreak rows into groups, and then apply the window function separately for each group.â€

**Example:**

```sql
SELECT department, salary,
       ROW_NUMBER() OVER (PARTITION BY department ORDER BY salary DESC) AS dept_rank
FROM employees;
```

This means:
â¡ï¸ Rank salaries **inside each department**, starting from 1 for the highest.

---

# ğŸŸ¦ Summary of Window Function Use-Cases

| Function         | What It Does                          |
| ---------------- | ------------------------------------- |
| **ROW_NUMBER()** | Unique rank, no ties                  |
| **RANK()**       | Rank with ties (skips numbers)        |
| **DENSE_RANK()** | Rank with ties (no skips)             |
| **LAG()**        | Look at previous row                  |
| **LEAD()**       | Look at next row                      |
| **NTILE(n)**     | Divide into n equal groups            |
| **SUM() OVER**   | Running total                         |
| **AVG() OVER**   | Moving average                        |
| **PARTITION BY** | Group rows logically without grouping |

---

# âœ”ï¸ Next Section?

Choose the next topic:

ğŸ‘‰ **Date & Time Functions**
ğŸ‘‰ **Conditional Logic (CASE, COALESCE)**

Just reply: **Continue Date Functions** or **Continue Conditional Logic**
